# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/introduction/learn-gitpod/gitpod-yaml)
# and commit this file to your remote git repository to share the goodness with others.

# Learn more from ready-to-use templates: https://www.gitpod.io/docs/introduction/getting-started/quickstart

# In doppler.yaml file we ALSO setup --project agility-game-kener --config dev. TO DO: fix duplication

image:
  file: .gitpod.Dockerfile

tasks:
  - before: | 
      doppler configure set token $DOPPLER_LOCAL_TOKEN
      doppler setup --project agility-game-kener --config dev
      mkdir -p ./static/kener
      env:
        PUBLIC_KENER_FOLDER=/workspace/kener/static/kener
        NODE_ENV=production
        PORT=3000
        API_IP=127.0.0.1
        MONITOR_YAML_PATH=/config/monitors.yaml
        SITE_YAML_PATH=/config/site.yaml
  - init: |
      doppler run -- npm install -g npm@10.4.0
      doppler run -- npm install
      doppler run --mount .env -- npm run build 


